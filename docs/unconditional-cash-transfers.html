<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Unconditional Cash Transfers | Econ5/Poli5D</title>
<meta name="author" content="David Arnold">
<meta name="description" content="10.1 Motivation   code {  background-color: #f1f1f1; } A central goal of development economics is to understand ways to alleviate global poverty. However, the exact design of policies is often up...">
<meta name="generator" content="bookdown 0.30 with bs4_book()">
<meta property="og:title" content="Chapter 10 Unconditional Cash Transfers | Econ5/Poli5D">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/geisel.jpg">
<meta property="og:description" content="10.1 Motivation   code {  background-color: #f1f1f1; } A central goal of development economics is to understand ways to alleviate global poverty. However, the exact design of policies is often up...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Unconditional Cash Transfers | Econ5/Poli5D">
<meta name="twitter:description" content="10.1 Motivation   code {  background-color: #f1f1f1; } A central goal of development economics is to understand ways to alleviate global poverty. However, the exact design of policies is often up...">
<meta name="twitter:image" content="/images/geisel.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Econ5/Poli5D</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li class="book-part">Excel</li>
<li><a class="" href="college-instruction-experiments.html"><span class="header-section-number">1</span> College Instruction Experiments</a></li>
<li class="book-part">Stata</li>
<li><a class="" href="intergenerational-mobility.html"><span class="header-section-number">2</span> Intergenerational Mobility</a></li>
<li><a class="" href="discrimination-in-police-stops.html"><span class="header-section-number">3</span> Discrimination in Police Stops</a></li>
<li><a class="" href="classroom-technology.html"><span class="header-section-number">4</span> Classroom Technology</a></li>
<li><a class="" href="legacy-of-colonial-medicine.html"><span class="header-section-number">5</span> Legacy of Colonial Medicine</a></li>
<li class="book-part">R</li>
<li><a class="" href="resume-experiments.html"><span class="header-section-number">6</span> Resume Experiments</a></li>
<li><a class="" href="the-rug-rat-race.html"><span class="header-section-number">7</span> The Rug Rat Race</a></li>
<li><a class="" href="automated-pollution-monitoring.html"><span class="header-section-number">8</span> Automated Pollution Monitoring</a></li>
<li><a class="" href="voting.html"><span class="header-section-number">9</span> Voting</a></li>
<li><a class="active" href="unconditional-cash-transfers.html"><span class="header-section-number">10</span> Unconditional Cash Transfers</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="unconditional-cash-transfers" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Unconditional Cash Transfers<a class="anchor" aria-label="anchor" href="#unconditional-cash-transfers"><i class="fas fa-link"></i></a>
</h1>
<div id="motivation" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Motivation<a class="anchor" aria-label="anchor" href="#motivation"><i class="fas fa-link"></i></a>
</h2>


<style>
code {
  background-color: #f1f1f1;
}
</style>
<p>A central goal of development economics is to understand ways to alleviate global poverty. However, the exact design of policies is often up for debate.</p>
<p>For example, imagine you are a charity or government that has funds to disburse to individuals in poverty. How would you go about doing this? One response is to make the transfers conditional. In other words, you give individuals cash to purchase particular items. For example, many programs allocate funds to be used for food or education.</p>
<p>Another way to disburse these funds is to do so unconditionally. This gives individuals the autonomy to decide for themselves what they would like to spend the money on. This week, we will use data from Haushofer and Shapiro (2016)<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Johannes Haushofer and Jeremy Shapiro, &lt;span&gt;“The Short-Term Impact of Unconditional Cash Transfers to the Poor: Experimental Evidence from Kenya,”&lt;/span&gt; &lt;em&gt;The Quarterly Journal of Economics&lt;/em&gt; 131, no. 4 (2016): 1973–2042.&lt;/p&gt;"><sup>15</sup></a></span>, which studies the impact of unconditional cash transfers in Kenya on the economic and psychological well-being of recipients. This study was made possible due to the charitable organization, Give Directly, a charity co-found by Paul Niehaus, professor of Economics at UC San Diego.</p>
<p>In particular, Haushofer and Shapiro randomize a couple of aspects including (1) whether a household receives an unconditional cash transfer and (2) the timing of the transfer (monthly vs. lump sum) and (3) the size of the transfer (small $400 or large $1500). A key strength of the study is that they can also study a wide range of outcomes, including assets, expenditures, food security, health, education expenditures, and psychological well being.</p>
<p>We will only be able to explore a fraction of all of these outcomes, and for this exercise we will focus on total assets. You can interpret assets as the amount of savings an individual has at a particular point in time. To get started, let's head over to R to load up the data.</p>
</div>
<div id="the-data" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> The Data<a class="anchor" aria-label="anchor" href="#the-data"><i class="fas fa-link"></i></a>
</h2>
<p>The data from this experiment is provided in the <code>uct.csv</code> file. First, we are again going to load <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>Now let's read in the <code>uct.csv</code> file:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="unconditional-cash-transfers.html#cb449-1" tabindex="-1"></a>uct <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"uct.csv"</span>)</span>
<span id="cb449-2"><a href="unconditional-cash-transfers.html#cb449-2" tabindex="-1"></a>Rows<span class="sc">:</span> <span class="dv">940</span> Columns<span class="sc">:</span> <span class="dv">19</span></span>
<span id="cb449-3"><a href="unconditional-cash-transfers.html#cb449-3" tabindex="-1"></a>── Column specification ────────────────────────────────────</span>
<span id="cb449-4"><a href="unconditional-cash-transfers.html#cb449-4" tabindex="-1"></a>Delimiter<span class="sc">:</span> <span class="st">","</span></span>
<span id="cb449-5"><a href="unconditional-cash-transfers.html#cb449-5" tabindex="-1"></a><span class="fu">dbl</span> (<span class="dv">19</span>)<span class="sc">:</span> treat, village, treatXfemalerec, asset_after, ...</span>
<span id="cb449-6"><a href="unconditional-cash-transfers.html#cb449-6" tabindex="-1"></a></span>
<span id="cb449-7"><a href="unconditional-cash-transfers.html#cb449-7" tabindex="-1"></a>ℹ Use <span class="st">`</span><span class="at">spec()</span><span class="st">`</span> to retrieve the full column specification <span class="cf">for</span> this data.</span>
<span id="cb449-8"><a href="unconditional-cash-transfers.html#cb449-8" tabindex="-1"></a>ℹ Specify the column types or set <span class="st">`</span><span class="at">show_col_types = FALSE</span><span class="st">`</span> to quiet this message.</span></code></pre></div>
<p>So we have 940 observations and 19 columns (i.e. variables). The first variable <code>treat</code> in is equal to 1 if the individual is in the treated group (received some cash payment) and zero of the individual is in the control group (did not receive a cash payment). Two variables we will be particularly interested in are <code>asset_before</code> and <code>asset_after</code>. In order to understand the impact of the cash transfer, we will compare the changes in assets for the treated workers relative to the change in assets that the control group experienced.</p>
<p>Although we will focus on assets, as mentioned previously, there are a wide range of variables in the data. For each variable, we have a measurement both before and after the cash payments were made. Given the range of variables in the data, this will allow for a comprehensive study of how individuals outcomes are impacted by cash transfers.</p>
<p>In the last columns, we also have information about the exact treatment. For example, the variable <code>treatXlarge</code> is equal to 1 if the individual is in the treatment group and the individual received a large cash transfer ($1500). The variable <code>treatXmonthlyXsmall</code> is equal to 1 if the individual is in the treatment group which received small monthly payments. Although we will not study the impact by each particular treatment, the design of the experiment also allows the authors understand how the size and timing of payments impacts overall welfare.</p>
<p>Next, we will start analyzing the data. However, to do so, we will introduce a new concept: user-written functions. So far, every function we have used has either come from base R or from a package we have loaded. In the next section, we will learn how to write our own functions.</p>
</div>
<div id="functions-part-1" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Functions (Part 1)<a class="anchor" aria-label="anchor" href="#functions-part-1"><i class="fas fa-link"></i></a>
</h2>
<p>To clarify how to write your own functions, let's first review what a function is. A function takes an input, performs some operations on this input, and then provides an output. For example, for the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function in R, the input will be a vector of numbers, and the output is the mean of the vector.</p>
<p>In data analysis, we often find ourselves repeating the same process over and over. Functions can help in these situations. If you find yourself repeating the same analysis over and over by copying and pasting code, but just changing small elements, then it might be time to put this analysis into a function.</p>
<p>This is precisely why R has provided the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function. We calculate means all the times. Therefore, it makes sense to have a function that will quickly compute the mean. But what if our analysis is more complicated? What if there is no standard function that performs it? In that case, we can write our own function.</p>
<p>So how do we go about creating a function in R. There are basically four things we need to decide. First, what will the function name be? Similar to choosing variable names, we want something relatively simple, but also descriptive. Second, what will be the inputs? For the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function the input is a list of numbers. But inputs can be anything: a vector, a character, a dataframe. Lastly, we decide on what the function does to the input to create the output.</p>
<p>Let's first introduce the general syntax, before writing our own simple function:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="unconditional-cash-transfers.html#cb450-1" tabindex="-1"></a>functionname <span class="ot">&lt;-</span> <span class="cf">function</span>(input) {</span>
<span id="cb450-2"><a href="unconditional-cash-transfers.html#cb450-2" tabindex="-1"></a>  </span>
<span id="cb450-3"><a href="unconditional-cash-transfers.html#cb450-3" tabindex="-1"></a>  Perform operations to produce output </span>
<span id="cb450-4"><a href="unconditional-cash-transfers.html#cb450-4" tabindex="-1"></a>  </span>
<span id="cb450-5"><a href="unconditional-cash-transfers.html#cb450-5" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb450-6"><a href="unconditional-cash-transfers.html#cb450-6" tabindex="-1"></a>  </span>
<span id="cb450-7"><a href="unconditional-cash-transfers.html#cb450-7" tabindex="-1"></a>}</span></code></pre></div>
<p>This can be a little abstract, so let's do an example with inputs, operations, and outputs that we understand. Let's manually create our own mean function.</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymean</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>The name of this function is <code>mymean</code>. Therefore, when I want to use it I can specify <code>mymean()</code>. The input is named <code>num</code>. The input is going to be a list of numbers. What does the function do to a list of numbers. It adds them up <code>sum(num)</code> and then divides by the number of elements in the list of numbers. For example, imagine my list of numbers is 3, 5 and 7. Then <code>sum(num)=3+5+7=15</code> and <code>length(num)=3</code>, implying <code>output&lt;-5</code>. The last line tells R to return this number as the output. Note that all of the code that create the output is within curly brackets. The curly brackets tell R when the function starts and when it ends.</p>
<p>We can actually see how this works by creating this vector in R.</p>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p>Now let's apply our function <code>mymean()</code> to the vector <code>myvec</code>.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="unconditional-cash-transfers.html#cb453-1" tabindex="-1"></a><span class="fu">mymean</span>(myvec)</span>
<span id="cb453-2"><a href="unconditional-cash-transfers.html#cb453-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">5</span></span></code></pre></div>
<p>Now that we understand the basics of creating our own function, let's create a function for our empirical application this week which studies the impact of unconditional cash transfers in Kenya.</p>
<p>Our goal is to compare assets between the treated and control households. Of course, we can do this without creating a function, we just need to take the mean of <code>asset_after</code> conditional on <code>treat==1</code> and then compare to the mean of <code>asset_after</code> conditional on <code>treat==0</code>.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="unconditional-cash-transfers.html#cb454-1" tabindex="-1"></a><span class="fu">mean</span>(uct<span class="sc">$</span>asset_after[uct<span class="sc">$</span>treat<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb454-2"><a href="unconditional-cash-transfers.html#cb454-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">790.9253</span></span></code></pre></div>
<p>So in the treatment group, on average, individuals have 791 dollars in assets after receiving the cash transfer. These measurements were taken 9 months after the treatment.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="unconditional-cash-transfers.html#cb455-1" tabindex="-1"></a><span class="fu">mean</span>(uct<span class="sc">$</span>asset_after[uct<span class="sc">$</span>treat<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb455-2"><a href="unconditional-cash-transfers.html#cb455-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">494.8041</span></span></code></pre></div>
<p>So in the control group, on average, individuals have 495 dollars in assets. What this result tells us is that 9 months after the program began, treated individuals still have higher savings than control individuals. This indicates that individuals do not immediately consume the transfer payment, but instead save some of it for the future.</p>
<p>One thing to notice is that the two lines of code we wrote to perform this analysis vary by a single number. In the first, we set <code>treat==1</code> and the second we set <code>treat==0</code>. If you find yourself writing the same code multiple times, but just changing a single element or two, this might be a good time to write a function.</p>
<p>We will now write a function that varies this one input: the treatment value. Then, depending on whatever treatment value you pass to the function, the function will compute the mean for individuals with that treatment value. Let's name our function <code>treatment</code> and have the input be <code>treatvalue</code>.</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatmean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">treatvalue</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">uct</span><span class="op">$</span><span class="va">asset_after</span><span class="op">[</span><span class="va">uct</span><span class="op">$</span><span class="va">treat</span><span class="op">==</span><span class="va">treatvalue</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>So this function is allowing the user to pass in a <code>treatvalue</code>, which in this case will be either zero or 1. Then, based on this <code>treatvalue</code> the function will calculate mean assets after for individuals with that <code>treatvalue</code>. For example, if we want to calculate the mean assets after for the treatment group we can type:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="unconditional-cash-transfers.html#cb457-1" tabindex="-1"></a><span class="fu">treatmean</span>(<span class="dv">1</span>)</span>
<span id="cb457-2"><a href="unconditional-cash-transfers.html#cb457-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">790.9253</span></span></code></pre></div>
<p>If we want to calculate the mean assets after for the control group, we type:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="unconditional-cash-transfers.html#cb458-1" tabindex="-1"></a><span class="fu">treatmean</span>(<span class="dv">0</span>)</span>
<span id="cb458-2"><a href="unconditional-cash-transfers.html#cb458-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">494.8041</span></span></code></pre></div>
<p>Now, there are often many different ways to code the same function. For example, imagine instead of using base R, we want to calculate this using the tidyverse.</p>
<div class="sourceCode" id="cb459"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatmean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">treatvalue</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="va">uct</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treat</span><span class="op">==</span><span class="va">treatvalue</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>assetmean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">asset_after</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, we can use the function in the same way we did before. Functions allow us not only to flexibly decide on what operations we want performed, but also how we implement these operations.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="unconditional-cash-transfers.html#cb460-1" tabindex="-1"></a><span class="fu">treatmean</span>(<span class="dv">1</span>)</span>
<span id="cb460-2"><a href="unconditional-cash-transfers.html#cb460-2" tabindex="-1"></a><span class="co"># A tibble: 1 × 1</span></span>
<span id="cb460-3"><a href="unconditional-cash-transfers.html#cb460-3" tabindex="-1"></a>  assetmean</span>
<span id="cb460-4"><a href="unconditional-cash-transfers.html#cb460-4" tabindex="-1"></a>      <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb460-5"><a href="unconditional-cash-transfers.html#cb460-5" tabindex="-1"></a><span class="dv">1</span>      <span class="fl">791.</span></span>
<span id="cb460-6"><a href="unconditional-cash-transfers.html#cb460-6" tabindex="-1"></a><span class="fu">treatmean</span>(<span class="dv">0</span>)</span>
<span id="cb460-7"><a href="unconditional-cash-transfers.html#cb460-7" tabindex="-1"></a><span class="co"># A tibble: 1 × 1</span></span>
<span id="cb460-8"><a href="unconditional-cash-transfers.html#cb460-8" tabindex="-1"></a>  assetmean</span>
<span id="cb460-9"><a href="unconditional-cash-transfers.html#cb460-9" tabindex="-1"></a>      <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb460-10"><a href="unconditional-cash-transfers.html#cb460-10" tabindex="-1"></a><span class="dv">1</span>      <span class="fl">495.</span></span></code></pre></div>
<p>In this section, we made a relatively simple function, a function to report means given a treatment value. In the next, we are going to expand on this simple example to create a more complicated function. With more complicated analysis, using functions may really save time and improve clarity.</p>
</div>
<div id="functions-part-2" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Functions (Part 2)<a class="anchor" aria-label="anchor" href="#functions-part-2"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we are going to extend our knowledge of functions in R, with a particular focus on using strings as inputs into functions. To focus ideas, let's talk about our goal for this section. We are going to write a function that takes in a single variable name (such as <code>"asset"``` or</code>"total_rev"``) and computes the mean of this variable both before and after the unconditional cash transfer program, for both the treated and control workers. Figure <a href="unconditional-cash-transfers.html#fig:functionfigure">10.1</a> depicts the goal of the function. We can input a single word (e.g. "asset") and retrieve the table depicted as the output.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:functionfigure"></span>
<img src="images/10_function_ex.png" alt="Goal for our Function" width="75%"><p class="caption">
Figure 10.1: Goal for our Function
</p>
</div>
<p>Instead of blanks in each cell, we will fill in with averages. So, for example, the cell in the top left is identified by treatment individuals after the policy has been implemented. If we supply the word <code>"asset"</code> to our function, then this first cell will be the average of <code>asset_after</code> for individuals with <code>treat==1</code>. We know from the last section, this will be 791. For our function in this section, we want the function to automatically fill in all these numbers. In order to do so, we will need to understand how we can supply a single string (e.g. "asset") and then have R pull the relevant variables and then calculate the relevant means for both treated and control individuals.</p>
<p>Why might this be useful? Once we write our function, we can simply change the variable name and retrieve comparisons between treated and control individuals. There are a lot of variables in this dataset that cover a wide range of economic and psychological outcomes, so it may be helpful to have a function that can quickly perform this analysis for different variables.</p>
<p>To understand how this function will work, let's first write it for one variable: <code>asset</code>. Once we have this code written we can put it into a function to make it more general. To start, let's create an object named <code>variable</code> that is equal to the string <code>"asset"</code>.</p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"asset"</span></span></code></pre></div>
<p>Next, let's from our object <code>variable</code>, we want to create the variable names <code>asset_after</code> and <code>asset_before</code>, because these are the names of the variables in our dataset. To do this, we need to learn how to concatenate two strings. Concatenating strings simply means combining them. In other words, if I concatenate "asset" with "_after" I get "asset_after". The function that allows us to do this in R is called the <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> function. Let's see how this works:</p>
<div class="sourceCode" id="cb462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variableafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>,<span class="st">"_after"</span><span class="op">)</span></span></code></pre></div>
<p>Now let's look at our new object:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="unconditional-cash-transfers.html#cb463-1" tabindex="-1"></a>variableafter</span>
<span id="cb463-2"><a href="unconditional-cash-transfers.html#cb463-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"asset _after"</span></span></code></pre></div>
<p>So if you look closely, you will see we actually have a problem. There is a space between <code>"asset"</code> and <code>"_after"</code>. This is a problem. We will want to use <code>variableafter</code> to reference a particular column in our data frame. But there is no column named <code>"asset _after"</code>. We need to tell <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> not to automatically add a space between our two strings. The way we can do this is by using an option called <code>sep=</code>. The option <code>sep=</code> stands for separator. It allows us to control what is put between two strings. If we want there to be no space between two strings, we can specify <code>sep=""</code>.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="unconditional-cash-transfers.html#cb464-1" tabindex="-1"></a>variableafter <span class="ot">&lt;-</span> <span class="fu">paste</span>(variable,<span class="st">"_after"</span>,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb464-2"><a href="unconditional-cash-transfers.html#cb464-2" tabindex="-1"></a>variableafter</span>
<span id="cb464-3"><a href="unconditional-cash-transfers.html#cb464-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"asset_after"</span></span></code></pre></div>
<p>So similarly, let's also construct <code>variablebefore</code>:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="unconditional-cash-transfers.html#cb465-1" tabindex="-1"></a>variablebefore <span class="ot">&lt;-</span> <span class="fu">paste</span>(variable,<span class="st">"_before"</span>,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb465-2"><a href="unconditional-cash-transfers.html#cb465-2" tabindex="-1"></a>variablebefore</span>
<span id="cb465-3"><a href="unconditional-cash-transfers.html#cb465-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"asset_before"</span></span></code></pre></div>
<p>Next, we want to get the average of these two variables for both the treated and control individuals. There are many ways we could approach this in R. Today, we are going to first construct two dataframes: one for treated individuals and one for control individuals. Then we are going to pull the relevant variables from the dataframes and take the average of these variables.</p>
<p>To start, let's separate out the treated and control data:</p>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uct_treat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">treat</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">uct_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">treat</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Next, we are going to use the <code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> function to grab the relevant columns. So this contrasts to other ways in which we have referenced variables with a dataframe. In the past, we have used either the <code>$</code> operator or in tidyverse we used <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> at times. The difference here is that our variable name is now in quotation marks. The value of <code>variablebefore</code> is <code>"asset_before"</code>. If we used the dollar sign to reference this variable, we would type <code>uct$asset_before</code>, not <code>uct$"asset_before"</code>. Instead, we are going to use the <code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> function, which allows us to use strings to reference variables. For example, to reference <code>asset_after</code> in the <code>uct_treat</code> data frame we can type <code>pull(uct_treat,variableafter)</code>. If we want to take the mean of this, we can put the entire expression inside the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="unconditional-cash-transfers.html#cb467-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pull</span>(uct_treat,variableafter))</span>
<span id="cb467-2"><a href="unconditional-cash-transfers.html#cb467-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">790.9253</span></span></code></pre></div>
<p>Now, let's repeat this process for the 3 remaining elements in the table that we want to create.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="unconditional-cash-transfers.html#cb468-1" tabindex="-1"></a><span class="co"># mean of variable after for control </span></span>
<span id="cb468-2"><a href="unconditional-cash-transfers.html#cb468-2" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pull</span>(uct_control,variableafter))</span>
<span id="cb468-3"><a href="unconditional-cash-transfers.html#cb468-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">494.8041</span></span>
<span id="cb468-4"><a href="unconditional-cash-transfers.html#cb468-4" tabindex="-1"></a></span>
<span id="cb468-5"><a href="unconditional-cash-transfers.html#cb468-5" tabindex="-1"></a><span class="co"># mean of variable before for treatment </span></span>
<span id="cb468-6"><a href="unconditional-cash-transfers.html#cb468-6" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pull</span>(uct_treat,variablebefore))</span>
<span id="cb468-7"><a href="unconditional-cash-transfers.html#cb468-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">382.3934</span></span>
<span id="cb468-8"><a href="unconditional-cash-transfers.html#cb468-8" tabindex="-1"></a></span>
<span id="cb468-9"><a href="unconditional-cash-transfers.html#cb468-9" tabindex="-1"></a><span class="co"># mean of variable before for control </span></span>
<span id="cb468-10"><a href="unconditional-cash-transfers.html#cb468-10" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pull</span>(uct_control,variablebefore))</span>
<span id="cb468-11"><a href="unconditional-cash-transfers.html#cb468-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">389.371</span></span></code></pre></div>
<p>For treated individuals, assets started at 382 and increased to 791. For control individuals, assets started at 389 and increased to 495. So while both groups saw an increase in assets over this time period, the treated individuals saw a much larger increase. This is evidence that the unconditional cash transfer is having a causal impact on savings.</p>
<p>We have now, successfully constructed the table, but only for assets. We want to be able to change the input each time and construct this for different variables. We could copy and paste the code above and repeat for different variables, but this will result in a long file of code which basically repeats the same process over and over. It will be much more efficient to put this code into a function.</p>
<p>Below we will display the function and then discuss the components:</p>
<div class="sourceCode" id="cb469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treat.mean.var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">variableafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_after"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">variablebefore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_before"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Separate out control and treated data</span></span>
<span>  <span class="va">uct_treat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">treat</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">uct_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">treat</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Use the pull function </span></span>
<span>  <span class="co">#Mean of variable after for treated</span></span>
<span>  <span class="va">treatafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct_treat</span>, <span class="va">variableafter</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Mean of variable after for control</span></span>
<span>  <span class="va">controlafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct_control</span>, <span class="va">variableafter</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Mean of variable before for treated</span></span>
<span>  <span class="va">treatbefore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct_treat</span>, <span class="va">variablebefore</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Mean of variable before for control</span></span>
<span>  <span class="va">controlbefore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct_control</span>, <span class="va">variablebefore</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Create output</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treatafter</span>, <span class="va">treatbefore</span>, <span class="va">controlafter</span>, </span>
<span>              <span class="va">controlbefore</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Treat After"</span>, <span class="st">"Treat Before"</span>, </span>
<span>                     <span class="st">"Control After"</span>, <span class="st">"Control Before"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is a function named <code>treat.mean.var</code> that takes <code>variable</code> as the input. We will pass in a variable from the data frame, for example <code>asset</code> or <code>nondurable_expend</code>. Until we reach the line that starts with <code>output</code>, all of the code is exactly what we did before. The code subsets to two separate dataframes, one for treated individuals and one for control individuals, and then calculates the mean of the variable both before and after the program.</p>
<p>The remaining code simply puts together the output in a way we will be able to understand. The line <code>output &lt;- c(treatafter,treatbefore, controlafter, controlbefore)</code> takes the four means and puts them into a single vector. The code <code>names(output)&lt;- c("Treat After", "Treat Before", "Control After", "Control Before")</code> is associating each entry in the vector with a name. This will allow us to understand what the function is presenting us without having to look through the function to figure it out everytime we execute it.</p>
<p>Let's give this new function a try using <code>"asset"</code> as the input:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="unconditional-cash-transfers.html#cb470-1" tabindex="-1"></a><span class="fu">treat.mean.var</span>(<span class="st">"asset"</span>)</span>
<span id="cb470-2"><a href="unconditional-cash-transfers.html#cb470-2" tabindex="-1"></a>   Treat After   Treat Before  Control After Control Before </span>
<span id="cb470-3"><a href="unconditional-cash-transfers.html#cb470-3" tabindex="-1"></a>      <span class="fl">790.9253</span>       <span class="fl">382.3934</span>       <span class="fl">494.8041</span>       <span class="fl">389.3710</span> </span></code></pre></div>
<p>Now that we have our function set up, let's look at another variable: nondurable expenditure. Nondurable expenditure are goods that are consumed over a short time period. For example, food is a common nondurable good.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="unconditional-cash-transfers.html#cb471-1" tabindex="-1"></a><span class="fu">treat.mean.var</span>(<span class="st">"nondurable_expend"</span>)</span>
<span id="cb471-2"><a href="unconditional-cash-transfers.html#cb471-2" tabindex="-1"></a>   Treat After   Treat Before  Control After Control Before </span>
<span id="cb471-3"><a href="unconditional-cash-transfers.html#cb471-3" tabindex="-1"></a>      <span class="fl">191.2080</span>       <span class="fl">174.3455</span>       <span class="fl">157.6120</span>       <span class="fl">183.5800</span> </span></code></pre></div>
<p>In the treatment, nondurable expenditures went up from 174 to 191. In contrast, in the control, nondurable expenditures actually decreased, starting at 184 and then falling to 158. Therefore, it appears unconditional cash transfers also had an impact on the amount individuals were spending on nondurable consumption.</p>
<p>Haushofer and Shapiro (2016) have a variety of other outcomes they measure. Now that we've written a function to do our analysis, we can quickly perform the analysis across these different variables. This is how functions can save you time when performing data analysis, and also improve the clarity of the code you do write, by making it more concise.</p>
</div>
<div id="conclusion-8" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion-8"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we are going to wrap up functions by reviewing how to construct them in R. We will perform a similar analysis as the previous section, however, in this section we will use linear regression to analyze the data. To set up our analysis, let's first write out the regression equation we will estimate:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 \cdot Treat_i + \varepsilon_i
\]</span></p>
<p>Our dependent variable will be the change in an outcome. For example, if we are interested in understanding how the treatment has impacted the change in assets for a household, then we will set <span class="math inline">\(Y_i\)</span> to be equal to <code>asset_after-asset_before</code>. We will estimate <span class="math inline">\(\hat{\beta}_1\)</span> which gives us the differential change in assets between treated and control individuals. For example, if <span class="math inline">\(\hat{\beta}_1=100\)</span>, then that indicates treated individuals experienced a larger increase in assets than individuals in the control group. For example, it could be that the control group experienced a 200 increase in assets over the two time periods we are studying, while the treated group experienced a 300 increase in assets over the two time periods. In this case, assets went up by 100 more in the treated group relative to the control group.</p>
<p>In this study, we have a number of variables that are in the format <code>variable_after</code> and <code>variable_before</code>. Instead of doing the linear regression with different variable names, we are instead going to write in a function that takes as an input "<code>variable''</code>, and then estimates the regression for this variable.</p>
<p>To understand how we will build the function, let's first estimate this regression for <code>asset</code>. That will give us an idea how we can do this more generally in a function. First, we need to create our <span class="math inline">\(Y_i\)</span> variable, which is equal to <code>asset_after-asset_before</code>.</p>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">uct</span><span class="op">$</span><span class="va">asset_after</span><span class="op">-</span><span class="va">uct</span><span class="op">$</span><span class="va">asset_before</span></span></code></pre></div>
<p>Note, we have not added our new variable <code>y</code> to our dataframe. It is currently a vector in our global environment. In all our previous examples, we have estimated a linear regression on variables within a dataframe. In this section, we will show you can also estimate linear regression on a pair of vectors. To do so, let's create a vector <code>treat</code> which is the same as the variable <code>treat</code> within the dataframe <code>uct</code>.</p>
<div class="sourceCode" id="cb473"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="va">uct</span><span class="op">$</span><span class="va">treat</span></span></code></pre></div>
<p>Now we can estimate the linear regression. Unlike most of the prior <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> models we have estimated, we do not need to specify the dataframe, as we are now directly utilizing vectors in our global environment. One could have done this by adding <code>y</code> to our dataframe as usual, but this illustration shows an alternative way to accomplish the same analysis.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="unconditional-cash-transfers.html#cb474-1" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> treat)</span>
<span id="cb474-2"><a href="unconditional-cash-transfers.html#cb474-2" tabindex="-1"></a>lm<span class="fl">.1</span></span>
<span id="cb474-3"><a href="unconditional-cash-transfers.html#cb474-3" tabindex="-1"></a></span>
<span id="cb474-4"><a href="unconditional-cash-transfers.html#cb474-4" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb474-5"><a href="unconditional-cash-transfers.html#cb474-5" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> treat)</span>
<span id="cb474-6"><a href="unconditional-cash-transfers.html#cb474-6" tabindex="-1"></a></span>
<span id="cb474-7"><a href="unconditional-cash-transfers.html#cb474-7" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb474-8"><a href="unconditional-cash-transfers.html#cb474-8" tabindex="-1"></a>(Intercept)        treat  </span>
<span id="cb474-9"><a href="unconditional-cash-transfers.html#cb474-9" tabindex="-1"></a>      <span class="fl">105.4</span>        <span class="fl">303.1</span>  </span></code></pre></div>
<p>We see that the slope coefficient <span class="math inline">\(\hat{\beta}_1 = 303.10\)</span>. This tells us that the treated group experienced an additional 303 dollar gain relative to the control group. If we look at the intercept, we know in this case this is the expected gain for individuals in the control group. In other words, individuals in the control group experienced a 105 dollar increase in assets. However, the slope coefficient tells us that the treated individuals experienced an additional 303 dollar gain, for a total gain of (105+303=408).</p>
<p>Now let's do this more generally using strings. Again, let's start by creating a string object called <code>variable</code> that is equal to <code>"asset"</code>.</p>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable</span>  <span class="op">&lt;-</span> <span class="st">"asset"</span></span></code></pre></div>
<p>Next, let's use <code>paste</code> to create <code>"asset_before"</code> and <code>"asset_after"</code>.</p>
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variableafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_after"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">variablebefore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_before"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Now we can create our <span class="math inline">\(Y_i\)</span> which is equal to <code>asset_after-asset_before</code>. Again we can use the <code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> function to grab the columns of the dataframe with the corresponding variable names:</p>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>,<span class="va">variableafter</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>,<span class="va">variablebefore</span><span class="op">)</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>,<span class="va">treat</span><span class="op">)</span></span></code></pre></div>
<p>Now we can run our linear regression just as before:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="unconditional-cash-transfers.html#cb478-1" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> treat)</span>
<span id="cb478-2"><a href="unconditional-cash-transfers.html#cb478-2" tabindex="-1"></a>lm<span class="fl">.1</span></span>
<span id="cb478-3"><a href="unconditional-cash-transfers.html#cb478-3" tabindex="-1"></a></span>
<span id="cb478-4"><a href="unconditional-cash-transfers.html#cb478-4" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb478-5"><a href="unconditional-cash-transfers.html#cb478-5" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> treat)</span>
<span id="cb478-6"><a href="unconditional-cash-transfers.html#cb478-6" tabindex="-1"></a></span>
<span id="cb478-7"><a href="unconditional-cash-transfers.html#cb478-7" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb478-8"><a href="unconditional-cash-transfers.html#cb478-8" tabindex="-1"></a>(Intercept)        treat  </span>
<span id="cb478-9"><a href="unconditional-cash-transfers.html#cb478-9" tabindex="-1"></a>      <span class="fl">105.4</span>        <span class="fl">303.1</span>  </span></code></pre></div>
<p>We have now figured out how to pass a string <code>"asset"</code> to an object named <code>variable</code> and perform the analysis. Therefore, we need to make only a few small changes to put this code into a function. We will name our function <code>lm.var</code> because it will perform a linear regression on an input variable.</p>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm.var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co">#Create a before and after variable</span></span>
<span>  <span class="va">variableafter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_after"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">variablebefore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="st">"_before"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Create a y variable</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">variableafter</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">variablebefore</span><span class="op">)</span></span>
<span>  <span class="va">treat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">uct</span>, <span class="va">treat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#Run the linear regression</span></span>
<span>  <span class="va">lm.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">treat</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">lm.1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To review, the first line <code>lm.var &lt;- function(variable) {</code> specifies a few things. First, the name of the function is <code>lm.var</code>. Second, the <code>function</code> tells R that we are creating a new function. <code>variable</code> will be the name of the input. This is what we will change each time we execute the function. To make sure this works, let's use this on <code>"asset"</code>. We have already performed this analysis so we know what it should return.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="unconditional-cash-transfers.html#cb480-1" tabindex="-1"></a><span class="fu">lm.var</span>(<span class="st">"asset"</span>)</span>
<span id="cb480-2"><a href="unconditional-cash-transfers.html#cb480-2" tabindex="-1"></a></span>
<span id="cb480-3"><a href="unconditional-cash-transfers.html#cb480-3" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb480-4"><a href="unconditional-cash-transfers.html#cb480-4" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> treat)</span>
<span id="cb480-5"><a href="unconditional-cash-transfers.html#cb480-5" tabindex="-1"></a></span>
<span id="cb480-6"><a href="unconditional-cash-transfers.html#cb480-6" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb480-7"><a href="unconditional-cash-transfers.html#cb480-7" tabindex="-1"></a>(Intercept)        treat  </span>
<span id="cb480-8"><a href="unconditional-cash-transfers.html#cb480-8" tabindex="-1"></a>      <span class="fl">105.4</span>        <span class="fl">303.1</span>  </span></code></pre></div>
<p>It appears our function is working properly. Now, we can repeat this analysis on many different variables. For example, let's see what this looks like for <code>total_rev</code>.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="unconditional-cash-transfers.html#cb481-1" tabindex="-1"></a><span class="fu">lm.var</span>(<span class="st">"total_rev"</span>)</span>
<span id="cb481-2"><a href="unconditional-cash-transfers.html#cb481-2" tabindex="-1"></a></span>
<span id="cb481-3"><a href="unconditional-cash-transfers.html#cb481-3" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb481-4"><a href="unconditional-cash-transfers.html#cb481-4" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> treat)</span>
<span id="cb481-5"><a href="unconditional-cash-transfers.html#cb481-5" tabindex="-1"></a></span>
<span id="cb481-6"><a href="unconditional-cash-transfers.html#cb481-6" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb481-7"><a href="unconditional-cash-transfers.html#cb481-7" tabindex="-1"></a>(Intercept)        treat  </span>
<span id="cb481-8"><a href="unconditional-cash-transfers.html#cb481-8" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">39.9</span>         <span class="fl">49.0</span>  </span></code></pre></div>
<p>Again, we see a positive impact for treated households. We see a bigger increase in the treated group in terms of household revenue relative to the control group.</p>
<div class="rmdnote">
<p>Concept check: Try this out for <code>nondurable_expend</code> and <code>food_security</code> and make sure you understand the resulting output.</p>
</div>
<p>In this section, we studied the effect of unconditional cash transfers on households in Kenya using data from Haushofer and Shapiro (2016). A key strength of Haushofer and Shapiro is the ability to collect a wide variety of outcomes. Their paper allows us to understand how unconditional cash transfers impact not only economic well being, but also psychological well being.
This paper relates to a broader and burgeoning literature on universal basic income (UBI). The merits of UBI have been debated intensely, in politics, the popular press, and in academia. The basic concept of UBI is that individuals receive a guaranteed cash payment. This will guarantee individuals a certain level of income, but some fear will lead to worse economic outcomes if individuals choose reduce work.</p>
<p>To date, there are very few examples of UBI payments that occur at a large scale for an extended time. For example, in Haushofer and Shapiro (2016), the authors give payments to a few hundred households over the course of about a year. However, through the same charity, GiveDirectly, researchers are currently implementing a large-scale UBI program in rural Kenya (see Banerjee et al. 2020). In this program, researchers are providing entire villages in rural Kenya with a universal basic income experiment for 12 years. The results of such a large-scale experiment will be tremendously informative regarding the pros and cons of UBI.</p>
</div>
<div id="function-descriptions-4" class="section level2 unnumbered">
<h2>
<u>Function Descriptions</u><a class="anchor" aria-label="anchor" href="#function-descriptions-4"><i class="fas fa-link"></i></a>
</h2>
<div class="rmdnote">
<p><strong><u>Functions Used</u></strong></p>
<ul>
<li><p><code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> -- Concatenates strings together. For example, <code>paste("Hello","World")</code> results in the text "Hello World".</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> -- Extracts columns from a dataframe. For example, given a dataframe <code>df</code> and a variable <code>varname</code>, we can extract the variable by specifying, <code>pull(df,"varname")</code>.</p></li>
<li><p><code>function()</code> -- Function to specify a new function in R.</p></li>
</ul>
</div>

</div>
</div>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><div class="chapter-nav">
<div class="prev"><a href="voting.html"><span class="header-section-number">9</span> Voting</a></div>
<div class="next"><a href="references-1.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#unconditional-cash-transfers"><span class="header-section-number">10</span> Unconditional Cash Transfers</a></li>
<li><a class="nav-link" href="#motivation"><span class="header-section-number">10.1</span> Motivation</a></li>
<li><a class="nav-link" href="#the-data"><span class="header-section-number">10.2</span> The Data</a></li>
<li><a class="nav-link" href="#functions-part-1"><span class="header-section-number">10.3</span> Functions (Part 1)</a></li>
<li><a class="nav-link" href="#functions-part-2"><span class="header-section-number">10.4</span> Functions (Part 2)</a></li>
<li><a class="nav-link" href="#conclusion-8"><span class="header-section-number">10.5</span> Conclusion</a></li>
<li><a class="nav-link" href="#function-descriptions-4">Function Descriptions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Econ5/Poli5D</strong>" was written by David Arnold. It was last built on 2023-12-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
